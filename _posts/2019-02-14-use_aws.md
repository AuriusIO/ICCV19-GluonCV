
# Run Notebooks on Amazon EC2

Pre-built environment as AMI for immediate use on EC2

# ami-06aea40327d6a56bc

Recommended instance type
- `p2.8xlarge`, `p3.2xlarge` (GPU instance)
- `c5.9xlarge` (CPU instance).


**We recommend you request GPU instance limits at least one day before the tutorial starts**.


We will go through how to allocate a CPU/GPU instance in AWS and launch the notebook step-by-step.

## Redeem Promotional Code

Promotional code should be redeemed by visiting AWS Credits https://aws.amazon.com/awscredits or by entering code via AWS account dashboard, under `credits`.

## Request GPU Instance Limits

For a newly created AWS account, usually it doesn't come with guaranteed GPU resources.
To check the GPU resource limit, please follow the below steps:

- Open the Amazon EC2 console at https://console.aws.amazon.com/ec2/.
- From the navigation bar, select a region.             
- From the navigation pane, choose Limits.
- Locate the resource in the list.

![](img/limits.png)

To request more capacity:
- Click the `Request limit increase` link and complete the required fields on the limit increase form. 
- AWS will respond using the contact method specified. The request often takes about one business day to process.

## Select and run an instance

We first need [an AWS account](https://aws.amazon.com/), and then go the EC2 console
after login in.

![](img/aws.png)




Select the following region: **EU Ireland**

Then click `launch instance` to select the operation system and instance type.

![](img/ec2.png)



Select **Community AMIs**, enter **ami-06aea40327d6a56bc** and click "Select":

![](img/choose-ami.png)

For instance type, the instance types below are recommended:
- `p2.8xlarge`, `p3.2xlarge` (GPU instance)
- `c5.9xlarge` (CPU instance).

![](img/p28x.png)

On the next step we increased the disk from 8 GB to **50 GB** to store a reasonable size dataset. 

If you selected a very powerful GPU
instance such as "p3.2xlarge", make sure you selected "Provisioned IOPS" in the
volume type for better I/O performance.

![](img/disk.png)

Then we launched with other options as the default values. 

The last step is choosing the ssh key, you may need to generate and store a key if
you don't have one before. 

Then click "Launch Instance".

![](img/keypair.png)

After clicked "launch instances", we can check the status by clicking the
instance ID link.

![](img/launching.png)

## Connect and Launch the Jupyter Notebook Remotely

Once the status is green, we can right-click and select "connect" to get the access instruction.

![](img/connect.png)

To launch the notebook remotely, we need to enable ssh with port forwarding.

### Linux/Mac

If you have any jupyter notebook server running locally, please turn it off for now.

Assuming your key name is `kdd18.pem` and public ip is `34.247.93.209`

For a new pem key, execute `chmod 400 kdd18.pem` before using it.

To connect to the remote instance, execute 

`ssh -i kdd18.pem ubuntu@34.247.93.209 -L 8888:localhost:8888`, 

where the port 8888 on remote instance is forward to localhost:8888.

![](img/connect-instance-osx.png)

### Windows

Follow the instructions in ["Configure a Windows Client: Set up PuTTY"](https://docs.aws.amazon.com/dlami/latest/devguide/setup-jupyter-configure-client-windows.html#setup-jupyter-win).


To launch jupyter notebook on port 8888, execute `jupyter notebook --port=8888`

![](img/run-notebook.png)

Finally, copy/paste the URL into your browser, and hit enter.

## Billing

You can set up [billing alerts](https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/monitor-charges.html) ASAP in order to avoid unwanted charges. If you want to close the account after the tutorial, please follow steps [here](https://aws.amazon.com/premiumsupport/knowledge-center/close-aws-account).
